create database bdLivrariaBrasileira
use bdLivrariaBrasileira

create table tbAutor(
idAutor int primary key IDENTITY(1,1)
,nomeAutor varchar(35) not null
)

create table tbGenero(
idGenero int primary key IDENTITY(1,1)
,nomeGenero varchar(19) not null
)

create table tbEditora (
idEditora int primary key IDENTITY(1,1)
,nomeEditora varchar(25) not null
)

create table tbLivro(
idLivro int primary key identity(1,1)
,nomeLivro varchar(58) not null
,numPaginas int not null 
,idGenero int foreign key references tbGenero(idGenero)
,idEditora int foreign key references tbEditora(idEditora)
,idAutor int foreign key references tbAutor(idAutor)
)

insert into tbGenero(nomeGenero)
	values('Ficção')
		,('Romance')
		,('Tragédia')



		select * from tbAutor


		drop table tbAutor
		drop table tbEditora
		drop table tbGenero
		drop table tbLivro

insert into tbEditora(nomeEditora)
			values('Melhoramentos')
			,('Globo')
			,('Atica')
			,('Companhia das Letras')
			,('Abril')



		insert into tbAutor(nomeAutor)
		values('Chico Buarque')
		,('Jorge Amado')
		,('J.K Rowling')
		,('William Shakespeare')
		,('Monteiro Lobato')
		,('Cora Coralina')
		,('Clarice Lispector')



	select * from tbAutor

insert into tbLivro(nomeLivro,numPaginas,idGenero,idEditora,idAutor)
			values('Budapeste','176','2','4','1')
			,('O Bicho da Seda','454','2','5','3')
			,('Gabriela Cravo e Canela','214','1','2','2')
			,('Reinaçoes de Narizinho','143','2','2','5')
			,('Romeu e Julieta ','421','1','3','4')
			,('O Irmão Alemão','478','1','4','1')
			,('Terras do sem-fim','125','1','3','2')
			,('Animas fantasticos e onde habitam','267','2','4','3')

		select * from tbLivro



//A

select nomeLivro as 'livretes'
from tbLivro 
where nomeLivro like 'p%';

//B
select min(numPaginas)as 'menor quantia de páginas ' from tbLivro 

//C
select max(numPaginas) as 'maior quantia de páginas' from tbLivro

//D
select avg(numPaginas) as 'Média de Páginas' from tbLivro

//E
select sum(numPaginas) as 'total Páginas com a Editora 3' from tbLivro
where idEditora like 3;

//F
select sum(numPaginas) as 'páginas com a letra A de inicio' from tbLivro
where nomeLivro like 'A%';

//G
select avg(numPaginas) as 'Média de páginas do autor 3' from tbLivro
where idAutor like 3;

//H
select sum(1) as 'Livros da Editora 4'
from tbLivro
where idEditora like 4;

//I
select avg(numPaginas) as 'Média de livros com a palavra estrela no nome' from tbLivro
where nomeLivro like '%estrela%'

//J
select sum(1) as 'livros com a palavra poema no nome' from tbLivro
where nomeLivro like '%POEMA%'




//K
select tbGenero.nomeGenero as 'Generos', count(idLivro) as 'livro de cada genero'
from tbGenero inner join tbLivro on tbGenero.idGenero = tbLivro.idGenero
group by nomeGenero

//L
select nomeAutor 'Autores' ,sum(numPaginas) as 'Qtd de páginas'
from tbAutor inner join tbLivro on tbAutor.idAutor = tbLivro.idAutor
group by nomeAutor;



//M
select nomeAutor as 'Autores' , avg(numPaginas) as 'Média de Páginas' 
from tbAutor inner join tbLivro on tbAutor.idAutor = tbLivro.idAutor
group by nomeAutor 
order by nomeAutor asc;


//N
select nomeEditora as 'Editora' ,count(idLivro) as 'Livros'
from tbEditora FULL join tbLivro on tbEditora.idEditora = tbLivro.idEditora
group by nomeEditora
order by nomeEditora DESC;



//O
select nomeAutor as 'Autores' ,sum(numPaginas) as 'Qtd total de Páginas dos livros'
from tbAutor inner join tbLivro on tbAutor.idAutor = tbLivro.idAutor
where nomeAutor like 'C%'
group by nomeAutor;


//P
select nomeAutor as 'Autores' ,count(idLivro) as 'qtd Livros ' 
from tbAutor full join tbLivro on tbAutor.idAutor = tbLivro.idAutor
where nomeAutor like 'Cora coralina%' or nomeAutor like  'Graciano Ramos%'  or nomeAutor like 'Clarice Lispector% ' or nomeAutor like 'Machado de Assis%'
group by nomeAutor;


//Q
select nomeEditora as 'Editoras' ,sum(numPaginas) as ' soma qtd Páginas ' 
from tbEditora inner join tbLivro on tbEditora.idEditora = tbLivro.idEditora
group by nomeEditora
having sum(numPaginas) between 200  and 500;

//R
select nomeAutor as 'Escritor' , tbLivro.nomeLivro as 'Livros ',tbEditora.nomeEditora
from tbAutor
inner join tbLivro on tbAutor.idAutor = tbLivro.idAutor inner join tbEditora on tbLivro.idEditora = tbEditora.idEditora


//S
select nomeLivro as 'Livros' , tbAutor.nomeAutor as 'Autores'
from tbLivro inner join tbAutor on tbAutor.idAutor = tbLivro.idAutor inner join tbGenero on tbGenero.idGenero = tbLivro.idGenero
where nomeGenero  like 'Cia das letras';

//T
select nomeAutor as 'Autores' , tbLivro.nomeLivro as 'Livros'
from tbAutor
inner join tbLivro on tbAutor.idAutor = tbLivro.idAutor
where nomeAutor not like 'Érico Verrísmo';

//U
select nomeAutor as 'Autores' ,nomeLivro as 'Livros'
from tbAutor full join tbLivro on tbAutor.idAutor = tbLivro.idAutor



//V
select nomeAutor as 'Autores', tbLivro.nomeLivro as 'Livros' 
from tbAutor
full join tbLivro on tbAutor.idAutor = tbLivro.idAutor


//W
select nomeAutor as 'autores' , nomeLivro as 'livrete' 
from tbAutor 
full join tbLivro on tbAutor.idAutor = tbLivro.idLivro 


//X
select l.nomeEditora , e.nomeLivro
from tbEditora as l
full join tbLivro as e
on l.idEditora = e.idLivro
where l.nomeEditora like 'atica';

//Y
 select nomeAutor as 'autores sem livros publicados' 
 from tbAutor
 full join tbLivro on tbAutor.idAutor = tbLivro.idAutor
 where tbLivro.idAutor is null;


 
//Z
 select nomeGenero as 'Genêros sem Livros cadastrados'
 from tbGenero
 full join tbLivro on tbGenero.idGenero = tbLivro.idGenero
 where tbLivro.idGenero is null;






